## 제5강 비트코인 블록체인 개요



- 개념은 같지만 각각 코인별로 다름



- ##### 비트코인 블록체인의 역할

  - 비트코인 발행을 포함한 모든 비트코인 지불 거래 정보를 기록한 장부(ledger)
  - 네트워크상의 비트코인 발행 내역과 이동 내역을 보여주는 장부
  - 비트코인의 P2P 거래를 가능하게 하는 원천(누구나 정상 지불 확인 가능)

- ##### 비트코인 블록체인의 목표

  - 완전성(complete blockchain)
    - 모든 거래 내역을 일관성 있게 기록
    - 발행되어 현재 사용되고 있는 모든 비트코인 현황을 일관성 있게 확인
  - 안전성(secure blockchain)
    - 비정상 거래 기록(승인) 불가
    - 승인된 거래 변경/교체 불가
    - 장부(블록체인) 파괴 불가
  - 분산성(distributed blockchain) / 비집중성(decentrailized blockchain)-탈중앙화
    - 누구나 블록체인 생성에 참여가능
    - 특정 참여자에 의존되지 않는 블록체인 유지
    - 그렇지만 누가 만들었던, 가지고 있던 일관성이 보장되는 블록체인
  - 투명성(transparent blockchain)
    - 누구나 블록체인 접근, 검증 및 사용가능
    - 블록체인을 유지하고 있지 않은 참여자도 블록체인 접근 보장(SPV 노드)

- ##### 비트코인 네트워크 참여자

  - 풀 노드(full node) 참여자
  - 채굴 노드(mining node) 참여자
  - SPV 노드 (simple payment verification node) - 대부분 스마트폰

- ##### 비트코인 블록

  - 블록(block)
    - 채굴자가 일정 시간 동안 비트코인 네트워크를 통해 교환되는 모든 거래를 검증한 후 모아서 만든 자료구조(장부)
    - 생성 후 모든 네트워크 참여자에게 전달(broadcasting-방송)
    - 블록체인을 유지하는 참여자는 자신의 블록체인에 수신된 블록을 연결
  - 블록 생성 간격
    - 시간 : 약 10분
    - 10분이 되도록 채굴 난이도 자동 조정
    - 10분 동안 발행된 전세계 비트코인 거래를 블록에 기록
  - 블록 크기
    - 1 Mbyte로 제한
    - 채굴자간에 블록 전달 지연시간(delay)이 커지는 문제를 방지하기 위함 -> 블록체인 분기(blockchain forking)에 따른 부실 블록 발생 방지
    - 10분당 승인할 수 있는 거래 수에 제약(초당7개)
    - 거래 정보의 크기는 250byte정도, 한 개의 블록에 40개정도 
    - 블록크기가 저길수록 전달 지연시간이 커짐 : 하드포크의 주된 이유?
  - 블록 채굴자(생성자) 결정
    - 작업증명(Proof of Work)에 가장 먼저 성공한 채굴자
    - 작업 문제(예) : 블록의 특정 숫자값(넌스-Nonce)를 변경하면서 성공 확률이 2^-60인 난이도의 목표값 보다 작은 해시값을 생성하는 넌스를 찾아라
      - 2의 60승 확률만큼 난이도
      - 이 때 넌스는 작업에 성공했다는 증명(Header에 기록)
    - 작업증명 : 난이도 목표값 보다 작은 해시값을 생성하는 넌스
    - 생성한 블록 배포시에 포함시켜 채굴자의 작업 증명 성공 사실을 누구나 확인 가능하게 함
  - 채굴자의 작업 증명 성공 확률
    - 채굴자의 해시 파워(해시율) / 전체 채굴자의 해시 파워의 총합
    - 해시파워 : 초당 해시값을 얼마나 계산할 수 있는지

- ##### 비트코인 블록체인

  - 블록 변경
    - 블록 변경은 해당 블록의 해시값 변경
    - 다음 블록의 해시포인터 변경 - > 다음 블록 변경으로 연결
    - 거의 불가능
  - 블록 조작 불가
    - 이후의 모든 블록 변경 필요 -> 작업 증명의 어려움으로 현실적으로 불가능
    - 뒤에 연결된 블록이 수가 많을 수록 블록 변경이 어려워짐
    - 6회 승인된 블록 변경은 불가능한 것으로 간주되고 있음

- ##### SPV 노드의 거래 승인 확인

  - SPV 노드
    - SPV 노드 : 블록 헤더 정보만 유지
    - 블록 헤더 : 해시 포인터, 난이도 목표, 넌스 , 머클 루트(머클 트리)
      - 머클 트리(Merkle tree) 거래 저장
        - 블록의 모든 거래에 대한 지문 정보 요약
      - 머클 경로(Merkle path)
        - 특정 거래의 존재 증명에 필요한 일련의 해시코드
        - 머클 경로의 크기 : log2 N, N은 전체 거래의 수
  - SPV 노드의 거래 승인 확인
    - 풀 노드로부터 블록 전체 다운로드 후 모든 거래 확인 경우 -> 네트워크와 처리노드에 부담