# 2강 이더리움 스마트계약2

### 이더리움 통화

- ETH의 발행

  - 참여자간의 지불 거래와 거래 수수료 지불을 위해 자체화폐(ETH) 발행
  - 초기 이더리움 프로젝트 수행 비용 조달을 위해 크라우드 세일(Crowd Sale) 방식으로 72,009,990,49948 ETH 선 발행
  - 이후 약 14초 마다 블록 채굴 보상금으로 일정액의 ETH를 계속 발행
  - 블록 보상 : 정규 블록 보상 (5ETH → 3ETH), 삼촌 불록 보상(87.5%), 조카 블록 보상(3.125%)

  

### 스마트 계약의 실행

- 가스 공급 기반의 거래를 통한 실행
  - 거래 실행 시에 실행에 요구되는 명령(instructions)의 종류와 수에 상응하는 비용을 지불
  - 자체 통화인 이더(ETH) 기반의 가스 공급(gas fueling) 메커니즘을 거래 실행에 도입
  - 이더리움의 거래는 소비할 수 있는 가스 한도를 명시하므로 무한정 많은 량의 가스 소비가 불가능
  - 공격자가 무한 루프를 사용한 DoS 공격 시도 불가

- 거래 유형
  - 계약 생성 거래(contract creation transaction)
    - EOA의 참여자가 Solidity 등으로 계약 프로그램을 작성하여 블록체인에 실장하기 위해 네트워크로 송신
    - 채굴자에 의해 처리되어 블록체인에 저장되면 해당 계약 프로그램에 의해 제어되는 CA가 생성되고 CA의 주소가 반환
  - 메시지 전송 거래(message transfer transaction)
    - 송신자 계좌와 수신자 계좌 간에 메시지를 전송
    - 수신 계좌가 EOA인 경우 메시지는 단순히 ETH 통화를 포함
    - 수신 계좌가 CA인 경우 CA의 계약 프로그램의 특정 함수를 호출하는 데 필요한 데이터를 추가로 포함 가능
- 거래 자료 구조
  - 넌스(nonce)
  - 가스가격(gasPrice)
  - 가스한도(gasLimit)
  - 수신자(to)
  - 값(value)
  - v, r, s(공개키와 주소 복구가 가능한 서명 정보)
  - 시작코드(init)
  - 데이터(data)



### 스마트 계약 실행을 위한 가스 공급

- 가스 - 암호 연료
  - 이더리움 거래 수수료는 필수로 설정
  - 거래 실행에 포함되는 명령의 종류와 수에 의해 결정
  - 송신자가 지불한 전체 수수료에서 거래 실행 과정에서 수행되는 명령 마다 필요한 수수료를 사용
  - 거래 실행이 안료되면 지불된 전체 수수료 중 명령 수행에 사용된 수수료를 제외한 나머지를 송신자 계좌에 반환